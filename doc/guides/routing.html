<!DOCTYPE html>
<!--####################################################################
	THIS IS A GENERATED FILE -- ANY CHANGES MADE WILL BE OVERWRITTEN

	INSTEAD CHANGE:
	source: docs/can-guides/experiment/technology/routing.md
	@page guides/routing
######################################################################## -->
<html lang="en">
<head>
	<meta charset="utf-8">
	<title>CanJS - Routing</title>
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
	
		<link rel="stylesheet" type="text/css" href="../static/bundles/bit-docs-site/static.css">
		<link rel="shortcut icon" sizes="16x16 24x24 32x32 48x48 64x64" href="/docs/images/canjs_favicon.ico">
		<link rel="apple-touch-icon" sizes="57x57" href="../../docs/images/canjs_favicon_57x57.png">
		<link rel="apple-touch-icon-precomposed" sizes="57x57" href="../../docs/images/canjs_favicon_57x57.png">
		<link rel="apple-touch-icon" sizes="72x72" href="../../docs/images/canjs_favicon_72x72.png">
		<link rel="apple-touch-icon" sizes="114x114" href="../../docs/images/canjs_favicon_114x114.png">
		<link rel="apple-touch-icon" sizes="120x120" href="../../docs/images/canjs_favicon_128x128.png">
		<link rel="apple-touch-icon" sizes="144x144" href="../../docs/images/canjs_favicon_144x144.png">
		<link rel="apple-touch-icon" sizes="152x152" href="../../docs/images/canjs_favicon_152x152.png">
		<meta content="yes" name="apple-mobile-web-app-capable">
	  	<meta name="apple-mobile-web-app-status-bar-style" content="white-translucent">
	
	
		<script>
			(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
				(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
				m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
			})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

			ga('create', 'UA-2302003-11', 'auto');
			ga('send', 'pageview');
		</script>
	
</head>
	<body>
		<input type="checkbox" id="nav-trigger" class="nav-trigger"/>
		<label for="nav-trigger">Menu</label>
	  	<div id="everything">
  <div id="left" class="column">
    <div class="top-left">
      
          <div class="brand">
	<div class="logo">
		<a href="../../index.html" alt="CanJS"></a>
		<div class="dropdown project-dropdown">
			<a href="https://donejs.com/">DoneJS</a>
			<a href="https://stealjs.com/">StealJS</a>
			<a href="https://jquerypp.com/">jQuery++</a>
			<a href="https://funcunit.com/">FuncUnit</a>
			<a href="https://documentjs.com/">DocumentJS</a>
		</div>
	</div>
	<div class="version">
		<div class="version-number">
			5.1.0
		</div>
		<div class="dropdown version-dropdown">
			
				<a href="https://v4.canjs.com">4.3.0</a>
			
				<a href="https://v3.canjs.com">3.13.1</a>
			
				<a href="https://v2.canjs.com">2.3.35</a>
			
		</div>
	</div>
</div>
<div class="search-bar">
	<div class="search-wrap" style="display:none;">
		<span class="search-icon"></span>
		<input
			type="text"
			size="6"
			class="search"
			placeholder="Search"
			autocomplete="off"
			autocorrect="off"
			autocapitalize="none"
			spellcheck="false"/>
			<span class="search-icon-cancel"></span>
	</div>
</div>


      
    </div>
    <div class="bottom">
      <div class="nav-menu">
        <div class="social-side-container">
          <ul class="social-side">
  <li>
    <a class="header-mobile github" href="https://github.com/canjs/canjs" target="_blank"><img class="social-icon-small" src="../../docs/images/github.png">Github</a>
  </li>
  <li>
    <a class="header-mobile twitter" href="https://twitter.com/canjs" target="_blank"><img class="social-icon-small" src="../../docs/images/twitter.png">Twitter</a>
  </li>
</ul>
<ul class="social-side">
  <li>
    <a class="header-mobile" href="https://gitter.im/canjs/canjs" target="_blank">Chat</a>
  </li>
  <li>
    <a class="header-mobile" href="http://forums.donejs.com/c/canjs" target="_blank">Forum</a>
  </li>
</ul>

        </div>
        
            
	<ul>
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="../about.html"
							title="Learn about CanJS’s mission, technical highlights, who uses CanJS, and our future roadmap.">
							About
						</a>
						

					</li>
				
			
		
			
				
					<li class="
           						parent
           						expanded">
						<a class="page"
							href="../guides.html"
							title="Welcome to CanJS! These guides are here to help you master CanJS development, get involved with the CanJS community,
and contribute back to CanJS.">
							Guides
						</a>
						
	<ul>
		
			
				
					<li>
						<span>essentials</span>
						
	<ul>
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="setup.html"
							title="Learn how to install CanJS in your environment.">
							Setting Up CanJS
						</a>
						

					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="technology-overview.html"
							title="Learn the basics of CanJS&#x27;s technology.">
							Technology Overview
						</a>
						

					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="html.html"
							title="Learn how to update HTML and listen to user interactions.">
							HTML
						</a>
						

					</li>
				
			
		
			
				
					<li class="current
           						
           						expanded">
						<a class="page"
							href="routing.html"
							title="Learn how to make your application respond to changes in the URL and work with the browser&#x27;s back and forward buttons.">
							Routing
						</a>
						

					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="data.html"
							title="Learn how to get, create, update, and delete backend service layer data.">
							Service Layer
						</a>
						

					</li>
				
			
		
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="debugging.html"
							title="Learn how to debug CanJS applications.">
							Debugging
						</a>
						

					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="forms.html"
							title="Learn how to create amazing &lt;form&gt;s with CanJS.">
							Forms
						</a>
						

					</li>
				
			
		
	</ul>


					</li>
				
			
		
			
				
					<li>
						<span>app guides</span>
						
	<ul>
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="chat.html"
							title="This guide will walk you through building a real-time chat application with CanJS’s Core libraries.  It takes about 30 minutes to complete.">
							Chat Guide
						</a>
						

					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="todomvc.html"
							title="This guide will walk you through building a slightly modified version of TodoMVC with CanJS’s Core libraries and can-fixture. It takes about 1 hour to complete.">
							TodoMVC Guide
						</a>
						

					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="atm.html"
							title="This guide will walk you through building and testing an Automated Teller Machine (ATM) application with CanJS’s
Core libraries.  You’ll learn how to do test driven development (TDD)
and manage complex state.  It takes about 2 hours to complete.">
							ATM Guide
						</a>
						

					</li>
				
			
		
	</ul>


					</li>
				
			
		
			
				
					<li class="
           						parent
           						">
						<a class="page"
							href="recipes.html"
							title="A listing of small examples that are useful for learning CanJS.">
							recipes
						</a>
						
	<ul>
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="recipes/canvas-clock.html"
							title="This guide walks you through building a clock with the Canvas API.">
							Canvas Clock (Simple)
						</a>
						

					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="recipes/credit-card-advanced.html"
							title="This guide walks through building a simple credit card payment form with validations. It doesn’t use
can-define. Instead it uses Kefir.js streams to make a ViewModel.
can-kefir is used to make the Kefir streams observable to can-stache.">
							Credit Card Guide (Advanced)
						</a>
						

					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="recipes/credit-card-simple.html"
							title="This guide walks through building a very simple credit card payment form.  It uses Stripe.js v2 API to create a token
which can be used to create a charge.  It also performs
simple validation on the payment form values.">
							Credit Card Guide (Simple)
						</a>
						

					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="recipes/cta-bus-map.html"
							title="This guide walks you through showing Chicago Transit Authority (CTA) bus locations on a Google Map.">
							CTA Bus Map (Medium)
						</a>
						

					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="recipes/file-navigator-advanced.html"
							title="This guide walks you through building a file navigation widget that requests data with fetch. It takes about 45 minutes to complete.">
							File Navigator Guide (Advanced)
						</a>
						

					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="recipes/file-navigator-simple.html"
							title="This guide walks you through building a simple file navigation widget.  It takes about 25 minutes to complete.  It was written with
CanJS 3.10. Check out the file-navigator-advanced
for an example that makes AJAX requests for its data and uses can-component.">
							File Navigator Guide (Simple)
						</a>
						

					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="recipes/playlist-editor.html"
							title="Learn how to use YouTube’s API to search for videos and make a playlist.  This makes authenticated requests with OAuth2. It uses jQuery++ for
drag/drop events. It shows using custom attributes and custom events.  This guide takes
an hour to complete.">
							Playlist Editor (Advanced)
						</a>
						

					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="recipes/signup-simple.html"
							title="This guide walks through building simple signup, login forms and a logout button.">
							Signup and Login (Simple)
						</a>
						

					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="recipes/text-editor.html"
							title="This guide walks you through building a basic rich text editor.">
							Text Editor (Medium)
						</a>
						

					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="recipes/tinder-carousel.html"
							title="This guide walks you through building a Tinder-like carousel. Learn how build apps that use dragging user interactions.">
							Tinder Carousel (Medium)
						</a>
						

					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="recipes/todomvc-with-steal.html"
							title="This tutorial walks through building TodoMVC with StealJS. It includes KeyNote presentations
covering CanJS core libraries.">
							TodoMVC with StealJS
						</a>
						

					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="recipes/video-player.html"
							title="This guide walks you through building custom video controls around a video element.">
							Video Player (Simple)
						</a>
						

					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="recipes/weather-report-advanced.html"
							title="This guides you through extending the Simple Weather Report Guide to remove imperative code and automatically look up the user’s location using the
browser’s geolocation API.  Both of these will be done with event streams.
This guide continues where the Simple Weather Report Guide left off.  It takes about 25 minutes to complete.  It was written with CanJS 4.1.">
							Weather Report Guide (Advanced)
						</a>
						

					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="recipes/weather-report-simple.html"
							title="This guide walks you through building a simple weather report widget.  It takes about 25 minutes to complete.  It was written with
CanJS 4.1.">
							Weather Report Guide (Simple)
						</a>
						

					</li>
				
			
		
	</ul>


					</li>
				
			
		
			
				
					<li>
						<span>upgrade</span>
						
	<ul>
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="../migrate-3.html"
							title="This guide walks you through the step-by-step process to upgrade a 2.x app to CanJS 3.">
							Migrating to CanJS 3
						</a>
						

					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="../migrate-4.html"
							title="This guide walks you through the step-by-step process to upgrade a 3.x app to CanJS 4.">
							Migrating to CanJS 4
						</a>
						

					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="../migrate-5.html"
							title="This guide walks you through the process to upgrade a 4.x app to CanJS 5.x.">
							Migrating to CanJS 5
						</a>
						

					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="upgrade/using-codemods.html"
							title="Learn how to migrate your app to CanJS 3 using can-migrate.">
							Using Codemods
						</a>
						

					</li>
				
			
		
	</ul>


					</li>
				
			
		
			
				
					<li>
						<span>other</span>
						
	<ul>
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="api.html"
							title="This page walks through how to use and understand CanJS’s API documentation.">
							Reading the Docs (API Guide)
						</a>
						

					</li>
				
			
		
	</ul>


					</li>
				
			
		
	</ul>


					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="../api.html"
							title="Welcome to the CanJS API documentation! This page is a cheat-sheet for the most common APIs within CanJS. Read the
technology-overview page for background on the following APIs.">
							API Docs
						</a>
						

					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="../community.html"
							title="Get involved with one of the most inviting communities on the internet!">
							Community
						</a>
						

					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="contribute.html"
							title="Learn how to contribute to CanJS!">
							Contributing
						</a>
						

					</li>
				
			
		
	</ul>


        
      </div>
      <div class="search-results-container">
	<div class="search-results-wrap"></div>
</div>

    </div>
  </div>
  <div id="right" class="column">
    <div class="top-right">
      <div class="top-right-top">
	<ul class="top-right-bitovi">
	  	<li class="dropdown">
	    	<a href="https://www.bitovi.com" class="bitovi icon-bits">Bitovi</a>
	    	<ul class="dropdown-menu">
	      		<li><a href="https://www.bitovi.com/">Bitovi.com</a></li>
	      		<li><a href="https://www.bitovi.com/blog">Blog</a></li>
	      		<li><a href="https://www.bitovi.com/design">Design</a></li>
	      		<li><a href="https://www.bitovi.com/development">Development</a></li>
	      		<li><a href="https://www.bitovi.com/training">Training</a></li>
	      		<li><a href="https://www.bitovi.com/open-source">Open Source</a></li>
	      		<li><a href="https://www.bitovi.com/about">About</a></li>
	      		<li><a href="https://www.bitovi.com/contact">Contact Us</a></li>
	    	</ul>
	  	</li>
	</ul>
	<div class="brand">
		<div class="logo">
			<a href="../../index.html" alt="CanJS"></a>
		</div>
	</div>
	<ul class="top-right-links">
  <li>
    <a href="https://gitter.im/canjs/canjs">Chat</a>
  </li>
  <li>
    <a href="http://forums.donejs.com/c/canjs">Forum</a>
  </li>
  <li>
    <a class="github-button nav-social" href="https://github.com/canjs/canjs" data-count-href="/canjs/canjs/stargazers" data-show-count="true">Star</a>
  </li>
  <li>
    <a href="https://twitter.com/canjs" class="twitter-follow-button nav-social" data-show-count="true" data-show-screen-name="false">Follow @canjs</a><script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>
  </li>
</ul>
</div>
<div class="breadcrumb">
	
		<li><a href="../../index.html">CanJS</a></li>
		<li> / </li>
	
		<li><a href="../guides.html">Guides</a></li>
		<li> / </li>
	
	
	<li><a href="routing.html">Routing</a></li>
	
	<li class="breadcrumb-dropdown-separator"> / </li>
	<li class="breadcrumb-dropdown breadcrumb-on-this-page">
		<a> On this page</a>
		<ul class="on-this-page"></ul>
	</li>
	<div class="nav-toggle" title="Back to top"></div>
</div>


    </div>
    <div class="bottom">
      <article>
  <section class="title">
	<div class="page-type">
		<h1>Routing</h1>
			<ul class="title-social">
				
				
				<li>
					<a class="button-link" href="//github.com/canjs/canjs/edit/master/docs/can-guides/experiment/technology/routing.md">Edit on GitHub</a>
				</li>
				
			</ul>
	</div>
	<div class="clear-both"></div>
	
  
	<section class="description">
    <p>Learn how to make your application respond to changes in the URL and work with the browser's back and forward buttons.</p>

</section>

  
	
</section>
<section class="on-this-page-table">
	<!--<h2 class="on-this-page-title" data-skip>Page Content</h2>-->
</section>










  
    <section class="body">
    <style>
table.panels .background td {
    background: #f4f4f4;
    padding: 5px 5px 5px 5px;
    border: solid 1px white;
    margin: 1px;
    vertical-align: top;
}
table.panels pre {
    margin-top: 0px;
}
.obs {color: #800020; font-weight: bold}
</style>
<h2>Overview</h2>
<blockquote>
<p><strong>NOTE</strong> This guide uses hash-based routing instead of pushstate because hash-based routing
is easier to setup. Pushstate routing requires server-support. Use <a href="../can-route-pushstate.html" title="An observable that can be used as can-route's can-route.urlData.
import { route, RoutePushstate } from &quot;can&quot;;

route.urlData = new RoutePushstate();
route.register( &quot;{page}&quot;, { page: &quot;home&quot; } );
route.start();

route.data.set(&quot;page&quot;, &quot;user&quot;);

location.pathname; // -&gt; &quot;/user&quot;">can-route-pushstate</a> for pushstate-based applications. The use of <a href="../can-route-pushstate.html" title="An observable that can be used as can-route's can-route.urlData.
import { route, RoutePushstate } from &quot;can&quot;;

route.urlData = new RoutePushstate();
route.register( &quot;{page}&quot;, { page: &quot;home&quot; } );
route.start();

route.data.set(&quot;page&quot;, &quot;user&quot;);

location.pathname; // -&gt; &quot;/user&quot;">can-route-pushstate</a> is almost identical to <a href="../can-route.html" title="Manage browser history and client state by synchronizing the window.location.hash with an observable.">can-route</a>.</p>
</blockquote>
<p>CanJS's routing works by two-way binding an <span class='obs'>observable</span> to
the <em>URL</em>. When the <span class='obs'>observable</span> changes, the <em>URL</em> will be updated.  This two way binding
is provided by <a href="../can-route.html" title="Manage browser history and client state by synchronizing the window.location.hash with an observable.">route</a>.</p>
<p>For example, you can connect the <code>myCounter</code> observable from
the <a href="technology-overview.html#Key_ValueObservables" title="Learn the basics of CanJS's technology.">Technology Overview's Key-Value Observables section</a> to <code>window.location</code> with:</p>
<pre><code class="language-html">&lt;mock-url&gt;&lt;/mock-url&gt;

&lt;script type=&quot;module&quot;&gt;
// Imports the &lt;mock-url&gt; element that provides
// a fake back, forward, and url controls.
import &quot;//unpkg.com/mock-url@^5.0.0&quot;;

import {DefineMap, route} from &quot;can&quot;;

const Counter = DefineMap.extend({
    count: {default: 0},
    increment() {
        this.count++;
    }
});

window.myCounter = new Counter();

route.data = myCounter;
route.start();
&lt;/script&gt;
</code></pre>
<div line-highlight='19-20'></div>
<div class='codepen'></div>
<p>This will add <code>#!&amp;count=0</code> to the <a href="https://developer.mozilla.org/en-US/docs/Web/API/Location">location</a> hash.</p>
<p>Now, if you called <code>myCounter.increment()</code> in the console, the <code>window.location</code> will
change to <code>#!count=1</code>. If you hit the back-button, <code>myCounter.count</code> would be
back to <code>0</code>:</p>
<pre><code class="language-js">myCounter.increment()
window.location.hash  //-&gt; &quot;#!&amp;count=1&quot;

history.back()
myCounter.count       //-&gt; 0
window.location.hash  //-&gt; &quot;#!&amp;count=0&quot;
</code></pre>
<div class='demo_wrapper' data-demo-src='demos/technology-overview/route-counter.html'></div>
<p><a href="../can-route.html" title="Manage browser history and client state by synchronizing the window.location.hash with an observable.">can-route</a> is used to setup a bi-directional relationship with an observable and
the browser's location.</p>
<p><img src="../../docs/can-guides/experiment/technology/observable-routing.png"
alt=""
class='bit-docs-screenshot'/></p>
<p>By default, <code>can-route</code> serializes the observable's data with <a href="../can-param.html" title="Serialize an object or array into a query string.">can-param</a>,
so that the following observable data produces the following url hashes:</p>
<pre><code class="language-js">{foo: &quot;bar&quot;}          //-&gt; &quot;#!&amp;foo=bar&quot;
{foo: [&quot;bar&quot;, &quot;baz&quot;]} //-&gt; &quot;#!&amp;foo[]=bar&amp;foo[]=baz&quot;
{foo: {bar: &quot;baz&quot;}}   //-&gt; &quot;#!&amp;foo[bar]=baz&quot;
{foo: &quot;bar &amp; baz&quot;}    //-&gt; &quot;#!&amp;foo=bar+%26+baz&quot;
</code></pre>
<blockquote>
<p><strong>NOTE</strong> <a href="../can-route.html" title="Manage browser history and client state by synchronizing the window.location.hash with an observable.">can-route</a> uses hash-bangs (<code>#!</code>) to comply with a now-deprecated
<a href="https://developers.google.com/webmasters/ajax-crawling/docs/getting-started">Google SEO</a>
recommendation.</p>
</blockquote>
<p>You can register routes that controls the relationship between the
observable and the browser's location. The following registers
a translation between URLs and route properties:</p>
<pre><code class="language-js">route.register(&quot;{count}&quot;)
</code></pre>
<p>This results in the following translation between observable data and url hashes:</p>
<pre><code class="language-js">{count: 0}                  //-&gt; &quot;#!0&quot;
{count: 1}                  //-&gt; &quot;#!1&quot;
{count: 1, type: &quot;counter&quot;} //-&gt; &quot;#!1&amp;type=counter&quot;
</code></pre>
<p>You can add data when the url is matched.  The following registers
data for when the URL is matched:</p>
<pre><code class="language-js">route.register(&quot;products&quot;, {page: &quot;products&quot;});
route.register(&quot;products/{id}&quot;, {page: &quot;products&quot;})
</code></pre>
<p>This results in the following translation between observable data and url hashes:</p>
<pre><code class="language-js">{page: &quot;products&quot;}          //-&gt; &quot;#!products&quot;
{page: &quot;products&quot;, id: 4}   //-&gt; &quot;#!products/4&quot;
</code></pre>
<p>Registering the empty route (<code>&quot;&quot;</code>) provides initial state for the
application. The following makes sure the count starts at 0 when the hash is empty:</p>
<pre><code class="language-js">route.register(&quot;&quot;,{count: 0});
</code></pre>
<div class='demo_wrapper' data-demo-src='demos/technology-overview/route-counter-registered.html'></div>
<h2>Routing and the root component</h2>
<p>Understanding how to use <a href="../can-route.html" title="Manage browser history and client state by synchronizing the window.location.hash with an observable.">can-route</a> within an application comprised of <a href="../can-component.html" title="Create a custom element that can be used to manage widgets or application logic.">can-component</a>s
and their <a href="../can-stache.html" title="Live binding Mustache and Handlebars-compatible templates.">can-stache</a> views and observable view-models can be tricky.</p>
<p>We'll use the following example to help make sense of it:</p>
<div class='demo_wrapper' data-demo-src='demos/technology-overview/route-mini-app.html'></div>
<p>This example shows the <code>&lt;page-login&gt;</code> component until someone has logged in.  Once they have
done that, it shows a particular component based upon the hash. If the hash is empty (<code>&quot;&quot;</code> or <code>&quot;#!&quot;</code>),
the <code>&lt;page-home&gt;</code> component is shown.  If the hash is like <code>tasks/{taskId}</code> it will show the <code>&lt;task-editor&gt;</code> component we created previously. (<em>NOTE: We will show how to persist changes
to todos in a upcoming service layer section.</em>)</p>
<p>The switching between different components is managed by a <code>&lt;my-app&gt;</code> component. The topology of
the application looks like:</p>
<p><img src="../../docs/can-guides/experiment/technology/routing-app-overview.png"
alt="The my-app component on top. The page-home, page-login, task-editor nodes are children of my-app. percent-slider component is a child of task-editor."
class='bit-docs-screenshot'/></p>
<p>In most applications, <a href="../can-route.html" title="Manage browser history and client state by synchronizing the window.location.hash with an observable.">can-route</a> is connected to the top-level component's
<a href="../can-component.prototype.ViewModel.html" title="Provides or describes a constructor function that provides values and methods
to the component’s view. The constructor function
is initialized with values specified by the component element’s data bindings.">ViewModel</a>. We are going to go through the process of
building <code>&lt;my-app&gt;</code> and connecting it
to <a href="../can-route.html" title="Manage browser history and client state by synchronizing the window.location.hash with an observable.">can-route</a>. This is usually done in four steps:</p>
<ol>
<li>Connect the top-level component's view-model to the routing <a href="../can-route.data.html" title="An observable key-value object used to cross bind to the url observable can-route.urlData. Set it to cross-bind a top level state object (Application ViewModel) to can-route.">data</a>.</li>
<li>Have the top-level component's <a href="../can-component.prototype.view.html" title="Provides a view to render directly within the component’s element. The view is rendered with the
component’s can-component::ViewModel instance.  &lt;content/&gt; elements within the view are replaced by the source elements within the component’s tag.">view</a> display the right sub-components based on the view-model state.</li>
<li>Define the top-level component's view-model (sometimes called <em>application view-model</em>).</li>
<li>Register routes that translate between the URL and the application view-model.</li>
</ol>
<h2>Connect a component's view-model to can-route</h2>
<p>To connect a component's view-model to can-route, we first need to create a basic
component. The following creates a <code>&lt;my-app&gt;</code> component that displays its <code>page</code> property and
includes links that will change the page property:</p>
<pre><code class="language-js">import Component from &quot;can-component&quot;;
import stache from &quot;can-stache&quot;;
import DefineMap from &quot;can-define/map/map&quot;;
import route from &quot;can-route&quot;;
import &quot;can-stache-route-helpers&quot;;

Component.extend({
    tag: &quot;my-app&quot;,
    view: stache(`
        The current page is {{page}}.
        &lt;a href=&quot;{{ routeURL(page='home') }}&quot;&gt;Home&lt;/a&gt;
        &lt;a href=&quot;{{ routeURL(page='tasks') }}&quot;&gt;Tasks&lt;/a&gt;
    `),
    ViewModel: {
        page: &quot;string&quot;
    }
})
</code></pre>
<blockquote>
<p><strong>NOTE:</strong> Your html needs a <code>&lt;my-app&gt;&lt;/my-app&gt;</code> element to be able to see the
component's content.  It should say &quot;The current page is .&quot;.</p>
</blockquote>
<p>To connect the component's VM to the url, we:</p>
<ul>
<li>set <a href="../can-route.data.html" title="An observable key-value object used to cross bind to the url observable can-route.urlData. Set it to cross-bind a top level state object (Application ViewModel) to can-route.">data</a> to the custom element.</li>
<li>call and <a href="../can-route.start.html" title="Initializes can-route.">start</a> to begin sending url values to the component.</li>
</ul>
<pre><code class="language-js">route.data = document.querySelector(&quot;my-app&quot;);
route.start();
</code></pre>
<p>At this point, changes in the URL will cause changes in the <code>page</code>
property. See this by clicking the links and the back/refresh buttons below:</p>
<div class='demo_wrapper' data-demo-src='demos/technology-overview/route-mini-app-start.html'></div>
<h2>Display the right sub-components</h2>
<p>When building components, we suggest designing the <a href="../can-component.prototype.view.html" title="Provides a view to render directly within the component’s element. The view is rendered with the
component’s can-component::ViewModel instance.  &lt;content/&gt; elements within the view are replaced by the source elements within the component’s tag.">view</a>
before the <a href="../can-component.prototype.ViewModel.html" title="Provides or describes a constructor function that provides values and methods
to the component’s view. The constructor function
is initialized with values specified by the component element’s data bindings.">ViewModel</a>.  This helps you figure out what logic
the <a href="../can-component.prototype.ViewModel.html" title="Provides or describes a constructor function that provides values and methods
to the component’s view. The constructor function
is initialized with values specified by the component element’s data bindings.">ViewModel</a> needs to provide an easily understood
<a href="../can-component.prototype.view.html" title="Provides a view to render directly within the component’s element. The view is rendered with the
component’s can-component::ViewModel instance.  &lt;content/&gt; elements within the view are replaced by the source elements within the component’s tag.">view</a>.</p>
<p>We'll use <a href="../can-stache.helpers.switch.html" title="">{{#switch(expression)}}</a> to switch between different components
based on a <code>componentToShow</code> property on the view-model. The result looks like the following:</p>
<pre><code class="language-js">Component.extend({
    tag: &quot;my-app&quot;,
    view: stache(`
        {{#switch(componentToShow)}}
            {{#case(&quot;home&quot;)}}
                &lt;page-home isLoggedIn:from=&quot;isLoggedIn&quot; logout:from=&quot;logout&quot;/&gt;
            {{/case}}
            {{#case(&quot;tasks&quot;)}}
                &lt;task-editor id:from=&quot;taskId&quot; logout:from=&quot;logout&quot;/&gt;
            {{/case}}
            {{#case(&quot;login&quot;)}}
                &lt;page-login isLoggedIn:bind=&quot;isLoggedIn&quot; /&gt;
            {{/case}}
            {{#default}}
                &lt;h2&gt;Page Missing&lt;/h2&gt;
            {{/default}}
        {{/switch}}
    `),
    ...
})
</code></pre>
<p>Notice that the view-model will need the following properties:</p>
<ul>
<li><strong>isLoggedIn</strong> - If the user is logged in.</li>
<li><strong>logout</strong> - A function that when called logs the user out.</li>
<li><strong>taskId</strong> - A taskId in the hash.</li>
</ul>
<p>We will implement these properties and <code>componentToShow</code> in the
<a href="../can-component.prototype.ViewModel.html" title="Provides or describes a constructor function that provides values and methods
to the component’s view. The constructor function
is initialized with values specified by the component element’s data bindings.">ViewModel</a>.</p>
<h2>Define the view-model</h2>
<p>Now that we've designed the <em>view</em> it's time to code the observable view-model
with the logic to make the view behave correctly. We implement the
<code>ViewModel</code> as follows:</p>
<pre><code class="language-js">Component.extend({
    tag: &quot;my-app&quot;,
    ...
    ViewModel: {
        // Properties that come from the url
        page: &quot;string&quot;,
        taskId: &quot;string&quot;,

        // A property if the user has logged in.
        // `serialize: false` keeps `isLoggedIn` from
        // affecting the `url` and vice-versa.
        isLoggedIn: {
            default: false,
            type: &quot;boolean&quot;,
            serialize: false
        },

        // We show the login page if someone
        // isn't logged in, otherwise, we
        // show what the url points to.
        get componentToShow(){
            if(!this.isLoggedIn) {
                return &quot;login&quot;;
            }
            return this.page;
        },

        // A function we pass to sub-components
        // so they can log out.
        logout() {
            this.isLoggedIn = false;
        }
    }
});
</code></pre>
<blockquote>
<p>NOTE: The <a href="../can-define.types.serialize.html" title="Defines custom serialization behavior for a property.">serialize</a> property behavior controls the
<a href="../can-define/map/map.prototype.serialize.html" title="Get a serialized representation of the map instance and its children.">serializable</a> properties of
a <a href="../can-define/map/map.html" title="Create observable objects.">DefineMap</a>. Only
serializable properties of the map are used by <a href="../can-route.html" title="Manage browser history and client state by synchronizing the window.location.hash with an observable.">can-route</a> to
update the url. <code>serialize: false</code> keeps <code>isLoggedIn</code> from
affecting the <code>url</code> and vice-versa. Getters like <code>componentToShow</code>
are automatically configured with <code>serialize: false</code>.</p>
</blockquote>
<p>Finally, our component works, but the urls aren't easy to
remember (ex: <code>#!&amp;page=home</code>). We will clean that up in the
next section.</p>
<h2>Register routes</h2>
<p>Currently, after the user logs in, the application will show <code>&lt;h2&gt;Page Missing&lt;/h2&gt;</code> because if the url hash is empty, <code>page</code> property will be undefined. To have <code>page</code>
be <code>&quot;home&quot;</code>, one would have to navigate to <code>&quot;#!&amp;page=home&quot;</code> ... yuck!</p>
<p>We want the <code>page</code> property to be <code>&quot;home&quot;</code> when the hash is empty.  Furthermore,
we want urls like <code>#!tasks</code> to set the <code>page</code> property.  We can do that
by registering the following route:</p>
<pre><code class="language-js">route.register(&quot;{page}&quot;, {page: &quot;home&quot;});
</code></pre>
<p>Finally, we want <code>#!tasks/5</code> to set <code>page</code> to <code>&quot;tasks&quot;</code> and <code>taskId</code>
to <code>&quot;5&quot;</code>.  Registering the following route does that:</p>
<pre><code class="language-js">route.register(&quot;tasks/{taskId}&quot;, {page: &quot;tasks&quot;});
</code></pre>
<p>Now the mini application is able to translate changes in the url to
properties on the component's view-model.  When the component's view-model
changes, the view updates the page.</p>
<script async src="https://static.codepen.io/assets/embed/ei.js"></script>

</section>

  


<script type="text/javascript">
  window.docObject = {"src":{"path":"docs/can-guides/experiment/technology/routing.md"},"description":"Learn how to make your application respond to changes in the URL and work with the browser's back and forward buttons.\n\n","name":"guides/routing","title":"Routing","type":"page","parent":"guides/essentials","order":3,"outline":"2","comment":" ","codepen":[["\"can\"","\"//unpkg.com/can@^5.0.0/core.mjs\""]],"pathToRoot":"../.."};
</script>
</article>
      
        <footer><p>CanJS is part of <a href="https://donejs.com" target="_blank">DoneJS</a>. Created and maintained by the core <a href="https://donejs.com/About.html#team" target="_blank">DoneJS team</a> and <a href="https://www.bitovi.com" target="_blank">Bitovi</a>. <strong>Currently 5.1.0.</strong></p>
</footer>
      
    </div>
  </div>
</div>
<survey-ad>
  <button aria-label="Close" class="close" type="button">
    <span aria-hidden="true">&times;</span>
  </button>
  <a href="https://donejs.com/survey.html" target="_blank">
    Help us improve CanJS by taking our community survey
  </a>
</survey-ad>


		
			<script>
				steal = {
				  	instantiated: {
				    	"bundles/bit-docs-site/static.css!$css" : null
				  	}
			  	};
			</script>
			<script type='text/javascript' data-main="bit-docs-site/static" src="../static/steal.production.js"></script>
		
		<script async defer src="https://buttons.github.io/buttons.js"></script>

		<!-- root-level elements with attributes necessary for the app -->
		<div path-prefix=".."></div>

	</body>
</html>
